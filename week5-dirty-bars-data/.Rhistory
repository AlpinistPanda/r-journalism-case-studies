bars <- read.csv("https://docs.google.com/spreadsheets/d/15TJZhuh7jKoO9fDr8LIcBr8T3vf_sUJudBD9L5o0rDM/pub?output=csv", stringsAsFactors=F)
View(bars)
head(bars,10)
library(knitr)
kable(head(bars,10))
head(table(bars$Restaurant.name))
restaurants <- bars %>%
group_by(Restaurant.name) %>%
summarize(Total.Incidents=n()) %>%
arrange(desc(Total.Incidents))
library(dplyr)
restaurants <- bars %>%
group_by(Restaurant.name) %>%
summarize(Total.Incidents=n()) %>%
arrange(desc(Total.Incidents))
head(restaurants,10)
head(restaurants,15)
devtools::install_github("vpnagraj/rrefine")
library(rrefine)
write.csv(bars, file = "data/bars.csv", row.names = FALSE)
refine_upload(file = "data/bars.csv", project.name = "bars_cleanup", open.browser = TRUE)
bars_clean <- refine_export(project.name = "bars_cleanup")
View(bars_clean)
bars <- read.csv("https://docs.google.com/spreadsheets/d/15TJZhuh7jKoO9fDr8LIcBr8T3vf_sUJudBD9L5o0rDM/pub?output=csv", stringsAsFactors=F)
write.csv(bars, file = "data/bars.csv", row.names = FALSE)
refine_upload(file = "data/bars.csv", project.name = "bars_cleanup", open.browser = TRUE)
bars <- read.csv("https://docs.google.com/spreadsheets/d/15TJZhuh7jKoO9fDr8LIcBr8T3vf_sUJudBD9L5o0rDM/pub?output=csv", stringsAsFactors=F)
count(unique(bars$Restaurant.name))
length(unique(bars$Restaurant.name))
write.csv(bars, file = "data/bars.csv", row.names = FALSE)
refine_upload(file = "data/bars.csv", project.name = "bars_cleanup", open.browser = TRUE)
bars_clean <- refine_export(project.name = "bars_cleanup")
length(unique(bars_clean$Restaurant.name))
length(unique(bars$Restaurant.name))
head(bars_clean)
bars_clean$zip <- as.numeric(gsub("[[:alpha:]]", "", bars_clean$citstzip))
View(bars)
View(bars_clean)
bars_clean$zip <- gsub("[[:alpha:]]", "", bars_clean$citstzip)
View(bars_clean)
head(bars_clean$zip)
bars_clean$zip <- gsub(",", "", bars_clean$zip)
bars_clean$zip <- gsub(" ", "", bars_clean$zip)
bars_clean$zip <- gsub("//*", "", bars_clean$zip)
View(bars_clean)
bars_clean$zip <- gsub(".", "", bars_clean$zip)
View(bars_clean)
bars_clean$zip <- gsub(",", "", bars_clean$zip)
bars_clean$zip <- gsub(" ", "", bars_clean$zip)
bars_clean$zip <- gsub("[[:alpha:]]", "", bars_clean$citstzip)
bars_clean$zip <- gsub(",", "", bars_clean$zip)
bars_clean$zip <- gsub(" ", "", bars_clean$zip)
bars_clean$zip <- gsub("//.", "", bars_clean$zip)
bars_clean$zip <- gsub("//*", "", bars_clean$zip)
View(bars_clean)
bars_clean$zip <- gsub("[.]", "", bars_clean$zip)
View(bars_clean)
bars_clean$zip <- gsub("[[:alpha:]]", "", bars_clean$citstzip)
bars_clean$zip <- gsub(",", "", bars_clean$zip)
bars_clean$zip <- gsub(" ", "", bars_clean$zip)
bars_clean$zip <- gsub(".", "", bars_clean$zip, fixed=TRUE)
bars_clean$zip <- gsub("*", "", bars_clean$zip, fixed=TRUE)
View(bars_clean)
bars_clean$zip <- gsub("/", "", bars_clean$zip, fixed=TRUE)
View(bars_clean)
bars_clean$state <- ""
bars_clean$state <- ifelse(grepl(" MA", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl(",MA", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl("MA.", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl(" NH", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl(" CT", bars_clean$citstzip,  ignore.case = TRUE), "Connecticut", bars_clean$state)
bars_clean$state <- ifelse(grepl(" RI", bars_clean$citstzip,  ignore.case = TRUE), "Rhode Island", bars_clean$state)
bars_clean$state <- ifelse(grepl(" VT", bars_clean$citstzip,  ignore.case = TRUE), "Vermont", bars_clean$state)
View(bars_clean)
bars_clean$state <- ifelse(grepl("New Hampshire", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
View(bars_clean)
bars_clean$state <- ifelse(grepl(" N H", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
View(bars_clean)
bars_clean$state <- ifelse(grepl("Rhode Island", bars_clean$citstzip,  ignore.case = TRUE), "Rhode Island", bars_clean$state)
View(bars_clean)
bars_clean$state <- ""
bars_clean$state <- ifelse(grepl(" MA", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl("M.A.", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl(",MA", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl("MA.", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl(" NH", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl("N.H.", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl("New Hampshire", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl(" N H", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl(" CT", bars_clean$citstzip,  ignore.case = TRUE), "Connecticut", bars_clean$state)
bars_clean$state <- ifelse(grepl(" RI", bars_clean$citstzip,  ignore.case = TRUE), "Rhode Island", bars_clean$state)
bars_clean$state <- ifelse(grepl("Rhode Island", bars_clean$citstzip,  ignore.case = TRUE), "Rhode Island", bars_clean$state)
bars_clean$state <- ifelse(grepl(" VT", bars_clean$citstzip,  ignore.case = TRUE), "Vermont", bars_clean$state)
View(bars_clean)
bars_clean$state <- ifelse((grepl(" RI", bars_clean$citstzip,  ignore.case = TRUE) & !grepl("Fall River", bars_clean$citstzip)), "Rhode Island", bars_clean$state)
View(restaurants)
bars_clean$state <- ""
bars_clean$state <- ifelse(grepl(" RI", bars_clean$citstzip,  ignore.case = TRUE), "Rhode Island", bars_clean$state)
bars_clean$state <- ifelse(grepl(" MA", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl("M.A.", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl(",MA", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl("MA.", bars_clean$citstzip,  ignore.case = TRUE), "Massachusetts", bars_clean$state)
bars_clean$state <- ifelse(grepl(" NH", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl("N.H.", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl("New Hampshire", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl(" N H", bars_clean$citstzip,  ignore.case = TRUE), "New Hampshire", bars_clean$state)
bars_clean$state <- ifelse(grepl(" CT", bars_clean$citstzip,  ignore.case = TRUE), "Connecticut", bars_clean$state)
bars_clean$state <- ifelse(grepl("Rhode Island", bars_clean$citstzip,  ignore.case = TRUE), "Rhode Island", bars_clean$state)
bars_clean$state <- ifelse(grepl(" VT", bars_clean$citstzip,  ignore.case = TRUE), "Vermont", bars_clean$state)
View(bars_clean)
bars_clean$address <- gsub(",.*", "", bars_clean$citstzip)
View(bars_clean)
bars_clean$town <- gsub(",.*", "", bars_clean$citstzip)
bars_clean$town <- gsub(" MA.*", "", bars_clean$town)
bars_clean$town <- gsub(".", "", bars_clean$town, fixed=TRUE)
View(bars_clean)
bars_clean$town <- gsub(" MA.*", "", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub(".", "", bars_clean$town, fixed=TRUE)
View(bars_clean)
bars_clean$town <- gsub(",.*", "", bars_clean$citstzip)
bars_clean$town <- gsub(" MA.*", "", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub("S.", "South ", bars_clean$town, ignore.case=T, fixed=TRUE)
bars_clean$town <- gsub("N.", "North ", bars_clean$town, ignore.case=T, fixed=TRUE)
bars_clean$town <- gsub("W.", "West  ", bars_clean$town, ignore.case=T, fixed=TRUE)
bars_clean$town <- gsub("E.", "East ", bars_clean$town, ignore.case=T, fixed=TRUE)
bars_clean$town <- gsub(",.*", "", bars_clean$citstzip)
bars_clean$town <- gsub(" MA.*", "", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub("S.", "South ", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub("N.", "North ", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub("W.", "West  ", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub("E.", "East ", bars_clean$town, ignore.case=T)
View(bars_clean)
bars_clean$town <- gsub(",.*", "", bars_clean$citstzip)
bars_clean$town <- gsub(" MA.*", "", bars_clean$town, ignore.case=T)
bars_clean$town <- gsub("S.", "South ", bars_clean$town, fixed=TRUE)
bars_clean$town <- gsub("N.", "North ", bars_clean$town, fixed=TRUE)
bars_clean$town <- gsub("W.", "West  ", bars_clean$town, fixed=TRUE)
bars_clean$town <- gsub("E.", "North ", bars_clean$town, fixed=TRUE)
View(bars_clean)
library(stringr)
bars_clean$town <- str_to_title(bars_clean$town)
View(bars_clean)
head(bars_clean[c("zip", "state", "town")],10)
